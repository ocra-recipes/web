\hypertarget{classZmpPreviewController}{\section{\-Zmp\-Preview\-Controller \-Class \-Reference}
\label{classZmpPreviewController}\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}}
}


\-Implementes an extended \-Z\-M\-P preview controller as an unconstrained \-Q\-P problem.  




{\ttfamily \#include $<$\-Zmp\-Preview\-Controller.\-h$>$}

\subsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classZmpPreviewController_a26b5bd0bdd476f70c2009d77d5495b24}{\-Zmp\-Preview\-Controller} (const double period, std\-::shared\-\_\-ptr$<$ \hyperlink{structZmpPreviewParams}{\-Zmp\-Preview\-Params} $>$ parameters)
\item 
virtual \hyperlink{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd}{$\sim$\-Zmp\-Preview\-Controller} ()
\item 
bool \hyperlink{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd}{initialize} ()
\item 
{\footnotesize template$<$typename Derived $>$ }\\void \hyperlink{classZmpPreviewController_aabdafde9ecc41a6d98134e0a01083d8a}{compute\-Optimal\-Input} (const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&zmp\-Ref, const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&com\-Vel\-Ref, const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&hk, \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&optimal\-U)
\item 
void \hyperlink{classZmpPreviewController_abbf80c91182c5e41ce60d3b7430a583e}{integrate\-Com} (\-Eigen\-::\-Vector\-Xd com\-Jerk, \-Eigen\-::\-Vector\-Xd hk, \-Eigen\-::\-Vector\-Xd \&hkk)
\item 
void \hyperlink{classZmpPreviewController_a7d559ce7ece62627b58f20cd01c9ce30}{table\-Cart\-Model} (\-Eigen\-::\-Vector2d hk, \-Eigen\-::\-Vector\-Xd ddhk, \-Eigen\-::\-Vector2d \&p)
\item 
void \hyperlink{classZmpPreviewController_a7fa5d122b80650cdd9869b666e1ad597}{table\-Cart\-Model} (\-Eigen\-::\-Vector\-Xd hkk, \-Eigen\-::\-Vector2d \&p)
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a39ffdba07960f90a6cce247065f12504}{build\-Ah} (const double \hyperlink{classZmpPreviewController_abf1a3ec8d1698afab1c20bba32b5a724}{dt})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a0114a8bdba920b9a7fb6b35e7b90ddd1}{build\-Bh} (const double \hyperlink{classZmpPreviewController_abf1a3ec8d1698afab1c20bba32b5a724}{dt})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a716fdc040e5eaf9f6fe00c652f205d73}{build\-Cp} (const double \hyperlink{classZmpPreviewController_a3a317d26cc1bbaf8811491724fdd1def}{cz}, const double \hyperlink{classZmpPreviewController_a344571f012aa58250d7625905681bf1b}{g})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a6b61c5f7bcda6b8df027771a8e43ea8b}{build\-Gp} (\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}{\-Cp}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Ah}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a32aeeb35ac5733702fba52df05fdf61d}{build\-Hp} (\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}{\-Cp}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}{\-Bh}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Ah}, const int \hyperlink{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}{\-Nc}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a58723464a66fc3a1122c613500bb2052}{build\-Ch} ()
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a877b1d91bdf6767d8be83ef2a67fedde}{build\-Gh} (\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}{\-Ch}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Ah}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_ac28b93f8e76b4bd00d418f80c330bb67}{build\-Hh} (\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}{\-Ch}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}{\-Bh}, \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Ah}, const int \hyperlink{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}{\-Nc}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_ad1322ec975c7d022feb24a40fff62f2e}{build\-Nu} (const double \hyperlink{classZmpPreviewController_ac611f084023404faba1ccfab573cd81d}{nu}, const int \hyperlink{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}{\-Nc})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a6af233960b02ee593f2b781967fc2f5e}{build\-Nw} (const double \hyperlink{classZmpPreviewController_a783427b817d77469e1f80426bede5310}{nw}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a23b30df39849a4f22c5ebf94b87e8425}{build\-Nb} (const double \hyperlink{classZmpPreviewController_a6716ee4c94e6f91e608ee1e29fbc7051}{nb}, const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np})
\item 
bool \hyperlink{classZmpPreviewController_a1f5bf084ce93391fbebd63e467d9adbc}{compute\-Foot\-Z\-M\-P} (\hyperlink{utils_8h_a4b6a8e135f90bd56e5a57a60efb42529}{\-F\-O\-O\-T} which\-Foot, \-Eigen\-::\-Vector\-Xd wrench, \-Eigen\-::\-Vector2d \&foot\-Z\-M\-P, \-Eigen\-::\-Vector\-Xd \&wrench\-In\-World\-Ref, ocra\-::\-Model\-::\-Ptr model, const double tolerance=1e-\/3)
\item 
bool \hyperlink{classZmpPreviewController_a46dfe0448f3f14927960a072dc42346d}{compute\-Global\-Z\-M\-P\-From\-Sensors} (\-Eigen\-::\-Vector\-Xd raw\-Left\-Foot\-Wrench, \-Eigen\-::\-Vector\-Xd raw\-Right\-Foot\-Wrench, ocra\-::\-Model\-::\-Ptr model, \-Eigen\-::\-Vector2d \&global\-Z\-M\-P)
\item 
void \hyperlink{classZmpPreviewController_aa4bbd8b205ae1d539620ec7d5f258d4a}{get\-F\-T\-Sensor\-Adjoint\-Matrix} (\hyperlink{utils_8h_a4b6a8e135f90bd56e5a57a60efb42529}{\-F\-O\-O\-T} which\-Foot, \-Eigen\-::\-Matrix\-Xd \&\-T, \-Eigen\-::\-Vector3d \&sensor\-Position, ocra\-::\-Model\-::\-Ptr model)
\end{DoxyCompactItemize}
\subsection*{\-Private \-Attributes}
\begin{DoxyCompactItemize}
\item 
const double \hyperlink{classZmpPreviewController_a3a317d26cc1bbaf8811491724fdd1def}{cz}
\item 
const double \hyperlink{classZmpPreviewController_a344571f012aa58250d7625905681bf1b}{g} = 9.\-8
\item 
const double \hyperlink{classZmpPreviewController_abf1a3ec8d1698afab1c20bba32b5a724}{dt}
\item 
const int \hyperlink{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}{\-Nc}
\item 
const int \hyperlink{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\-Np}
\item 
const double \hyperlink{classZmpPreviewController_ac611f084023404faba1ccfab573cd81d}{nu}
\item 
const double \hyperlink{classZmpPreviewController_a783427b817d77469e1f80426bede5310}{nw}
\item 
const double \hyperlink{classZmpPreviewController_a6716ee4c94e6f91e608ee1e29fbc7051}{nb}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_ac3e92145988993ede7ce2060b997c8db}{\-Nu}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a5e85354a1a7c3f2a8e265dbe7367051c}{\-Nw}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_abd345d397e99ae01ad4ea80cd9894802}{\-Nb}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Ah}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}{\-Bh}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}{\-Cp}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a53a7d8af5be4a5d5cea99fad2ea48979}{\-Gp}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a32ab17a3be30490e4a1e874bf3581843}{\-Hp}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}{\-Ch}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a9429cb06fdd2c3ca5036a2fd48303632}{\-Gh}
\item 
const \-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a8caaf8bf8f06e5b0b53d2cd5c131eefd}{\-Hh}
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a2afe60ed4923414ce4e51a8a7a584fde}{\-A\-Optimal}
\item 
\-Eigen\-::\-Matrix\-Xd \hyperlink{classZmpPreviewController_a049829dccbeb5a7a1bf47f7e6679174a}{b\-Optimal}
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Implementes an extended \-Z\-M\-P preview controller as an unconstrained \-Q\-P problem. 

\begin{DoxyNote}{\-Note}
\-Put original \-Z\-M\-P preview control reference along with \-Aurelien's
\end{DoxyNote}
\begin{DoxyAuthor}{\-Author}
\-Jorhabib \-Eljaik
\end{DoxyAuthor}
\cite{ibanezThesis2015}

\begin{DoxyWarning}{\-Warning}
\-Work in progress! \-This is still a barebone class in the process of being tested.
\end{DoxyWarning}
\-Given a rough \-Z\-M\-P trajectory and a corresponding consistent \-Co\-M horizontal velocity, this class computes at a fast rate optimal \-Co\-M jerks over a refined preview horizon. \-The \-Z\-M\-P preview control formulation in (reference goes here) is extended to account for a \-Co\-M velocity tracking objective in order to minimize the error over a preview horizon to reference \-Co\-M velocities. \-This preview controller solves the following problem in a time window of size $N_c$

\begin{align*} \mathcal{U}_{k+N_c|k}^* = \underset{\mathcal{U}_{k+N_c|k}}{\text{arg min}} \; \sum_{j=1}^{N} & \eta_b || \mathbf{p}_{k+j|k} - \mathbf{r}_{k+j|k}^r ||^2 + \eta_w ||\mathbf{\dot{h}}_{k+j|k} - \dot{\mathbf{h}}^r_{k+j|k} ||^2 + \eta_u || \mathbf{u} ||^2 \\ \text{such that}&\\ \mathbf{p} &= \mathbf{h} - \mathbf{c}\mathbf{e}_2 \mathbf{\ddot{h}} \\ \mathbf{\hat{h}}_{k+j+1|k} &= \mathbf{A}_h \hat{\mathbf{h}}_{k+j|k} + \mathbf{B}_h \mathbf{u}_{k+j+1|k} \\ \mathbf{h}_{k+j|k} &= \mathbf{h}_k\\ \mathbf{h} &= \mathbf{c} - (\mathbf{c}\cdot\mathbf{e}_2)\mathbf{e}_2 \end{align*}

\-Where ${U}_{k+N_c|k}^*$ is the optimal horizon of inputs, $\mathbf{p}$ is the horizontal \-Z\-M\-P coordinate, $ \mathbf{r}^r $ \-Z\-M\-P references (in `walking-\/client` it's the interpolated \-Z\-M\-P reference from the walking \hyperlink{namespaceMIQP}{\-M\-I\-Q\-P} problem) $ \mathbf{\dot{h}} $ the horizontal \-Co\-M velocity, $ \mathbf{\dot{h}}^r $ \-Co\-M horizontal velocity reference (in walking-\/client it's the interpolated \-Co\-M velocity reference from the walking \hyperlink{namespaceMIQP}{\-M\-I\-Q\-P} problem). $\mathbf{u}$ is the input \-Co\-M jerk, $\mathbf{c}$ the three-\/dimensional \-Co\-M position. \-The horizontal \-Co\-M state is denoted $\hat{\mathbf{h}} = (\mathbf{h}, \mathbf{\dot{h}}, \mathbf{\ddot{h}}) $ (\-Co\-M horizontal position, velocity and acceleration respectively) while $\mathbf{e}_2$ is the vertical unit vector $ [0\;0\;1]^T$. $\mathbf{A}_h$ and $\mathbf{B}_h$ are integration matrices.

\-The previously described problem is an unconstrained \-Q\-P problem which has a closed-\/form solution. \-The same can be expressed in matrix form as\-:

\[ \underset{\mathbf{U}}{\text{min}} \; (\mathbf{P}_r - \mathbf{P})^T \mathbf{N}_b (\mathbf{P}_r - \mathbf{P}) + (\tilde{\mathbf{H}}_r - \mathbf{H})^T\mathbf{N}_w(\tilde{\mathbf{H}}_r - \mathbf{H}) + \mathbf{U}^T\mathbf{N}_u \mathbf{U} \]

\-Where\-: \begin{align*} \mathbf{U}^T &= \left[ \mathbf{u}^T_{k+1|k}, \cdots, \mathbf{u}^T_{k+N_c|k} \right]^T \\ \mathbf{P}^T &= \left[ \mathbf{p}^T_{k+1|k}, \cdots, \mathbf{p}^T_{k+N_p|k} \right]^T \\ \mathbf{P}^T_r &= \left[ \mathbf{r}^T_{k+1|k}, \cdots, \mathbf{r}^T_{k+N_p|k} \right]^T \\ \mathbf{\tilde{H}}^T &= \left[ \dot{\mathbf{h}}^T_{k+1|k}, \cdots, \dot{\mathbf{h}}^T_{k+N_p|k} \right]^T \\ \mathbf{\tilde{H}}^T_r &= \left[ \dot{\mathbf{h}^r}^T_{k+1|k}, \cdots, \dot{\mathbf{h}^r}^T_{k+N_p|k} \right]^T \\ \mathbf{N}_b &= \eta_b\left[\begin{array}{ccc} 1 & \cdots & 0 \\ \vdots & \ddots & \vdots\\ 0 & \cdots & 1 \end{array}\right] \end{align*}

$\mathbf{N}_w$ and $\mathbf{N}_u$ have a similar structure to $\mathbf{N}_b$.

\-A closed-\/form solution can thus be found and is equal to\-: \[ \mathbf{U}_{k+N_c|k} = (\mathbf{H}_p^T \mathbf{N}_b \mathbf{H}_p + \mathbf{N}_u + \mathbf{H}_h^T \mathbf{N}_w \mathbf{H}_h)^{-1} \left(\mathbf{H}^T_p \mathbf{N}_b (\mathbf{P}_r - \mathbf{G}_p \hat{\mathbf{h}}_k) + \mathbf{H}^T_h\mathbf{N}_w(\tilde{\mathbf{H}}_r - \mathbf{G}_h \hat{\mathbf{h}}_k)\right) \] 

\subsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classZmpPreviewController_a26b5bd0bdd476f70c2009d77d5495b24}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}}
\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Zmp\-Preview\-Controller}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Zmp\-Preview\-Controller\-::\-Zmp\-Preview\-Controller} (
\begin{DoxyParamCaption}
\item[{const double}]{period, }
\item[{std\-::shared\-\_\-ptr$<$ {\bf \-Zmp\-Preview\-Params} $>$}]{parameters}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a26b5bd0bdd476f70c2009d77d5495b24}
\-Class constructor. \-Builds all the time-\/invariant matrices used to compute the optimal output of the preview controller. 
\begin{DoxyParams}{\-Parameters}
{\em period} & \-Period (in ms) of the thread in which an object of this class is created. \\
\hline
{\em parameters} & \-An object containing the main parameters. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
struct \hyperlink{structZmpPreviewParams}{\-Zmp\-Preview\-Params} for details on the parameters. 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!$\sim$\-Zmp\-Preview\-Controller@{$\sim$\-Zmp\-Preview\-Controller}}
\index{$\sim$\-Zmp\-Preview\-Controller@{$\sim$\-Zmp\-Preview\-Controller}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{$\sim$\-Zmp\-Preview\-Controller}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Zmp\-Preview\-Controller\-::$\sim$\-Zmp\-Preview\-Controller} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd}


\subsection{\-Member \-Function \-Documentation}
\hypertarget{classZmpPreviewController_a39ffdba07960f90a6cce247065f12504}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Ah@{build\-Ah}}
\index{build\-Ah@{build\-Ah}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Ah}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Ah} (
\begin{DoxyParamCaption}
\item[{const double}]{dt}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a39ffdba07960f90a6cce247065f12504}
\-Builds $A_h$. \-Called during the member list initialization of the constructor of this class.


\begin{DoxyParams}{\-Parameters}
{\em dt} & \hyperlink{classThread}{\-Thread} period in which this classed in instantiated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The constant matrix \-Ah. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\-Zmp\-Preview\-Controller\-::\-Ah} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a0114a8bdba920b9a7fb6b35e7b90ddd1}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Bh@{build\-Bh}}
\index{build\-Bh@{build\-Bh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Bh}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Bh} (
\begin{DoxyParamCaption}
\item[{const double}]{dt}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a0114a8bdba920b9a7fb6b35e7b90ddd1}
\-Builds $B_h$. \-Called during the member list initialization of the constructor of this class.


\begin{DoxyParams}{\-Parameters}
{\em dt} & \hyperlink{classThread}{\-Thread} period in which this classed in instantiated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The constant matrix \-Bh. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}{\-Zmp\-Preview\-Controller\-::\-Bh} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a58723464a66fc3a1122c613500bb2052}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Ch@{build\-Ch}}
\index{build\-Ch@{build\-Ch}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Ch}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Ch} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a58723464a66fc3a1122c613500bb2052}
\-Builds $C_h$. \-Called during the member list initialization of the constructor of this class

\begin{DoxyReturn}{\-Returns}
$C_h$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}{\-Zmp\-Preview\-Controller\-::\-Ch} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a716fdc040e5eaf9f6fe00c652f205d73}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Cp@{build\-Cp}}
\index{build\-Cp@{build\-Cp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Cp}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Cp} (
\begin{DoxyParamCaption}
\item[{const double}]{cz, }
\item[{const double}]{g}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a716fdc040e5eaf9f6fe00c652f205d73}
\-Builds $C_p$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em cz} & \-Constant \-Co\-Mheight. \\
\hline
{\em g} & \-Constant gravity acceleration (m$^\wedge$2/s)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$C_p$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}{\-Zmp\-Preview\-Controller\-::\-Cp} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a877b1d91bdf6767d8be83ef2a67fedde}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Gh@{build\-Gh}}
\index{build\-Gh@{build\-Gh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Gh}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Gh} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ch, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ah, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a877b1d91bdf6767d8be83ef2a67fedde}
\-Builds $G_h$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em \-Ch} & $C_h$ \\
\hline
{\em \-Ah} & $A_h$ \\
\hline
{\em \-Np} & $N_p$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$G_h$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a9429cb06fdd2c3ca5036a2fd48303632}{\-Zmp\-Preview\-Controller\-::\-Gh} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a6b61c5f7bcda6b8df027771a8e43ea8b}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Gp@{build\-Gp}}
\index{build\-Gp@{build\-Gp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Gp}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Gp} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Cp, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ah, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a6b61c5f7bcda6b8df027771a8e43ea8b}
\-Builds $G_p$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em \-Cp} & $C_p$ \\
\hline
{\em \-Ah} & $A_h$ \\
\hline
{\em \-Nc} & $N_p$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$G_p$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a53a7d8af5be4a5d5cea99fad2ea48979}{\-Zmp\-Preview\-Controller\-::\-Gp} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_ac28b93f8e76b4bd00d418f80c330bb67}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Hh@{build\-Hh}}
\index{build\-Hh@{build\-Hh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Hh}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Hh} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ch, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Bh, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ah, }
\item[{const int}]{\-Nc, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_ac28b93f8e76b4bd00d418f80c330bb67}
\-Builds $H_h$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em \-Ch} & $C_h$ \\
\hline
{\em \-Bh} & $B_h$ \\
\hline
{\em \-Ah} & $A_h$ \\
\hline
{\em \-Hh} & $N_c$ \\
\hline
{\em \-Nc} & $N_p$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$H_h$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a8caaf8bf8f06e5b0b53d2cd5c131eefd}{\-Zmp\-Preview\-Controller\-::\-Hh} 
\end{DoxySeeAlso}
\begin{DoxyRefDesc}{\-Todo}
\item[\hyperlink{todo__todo000014}{\-Todo}]\-Check the first for loop of this method. \-I think this should be \-Np -\/ 1 \end{DoxyRefDesc}
\hypertarget{classZmpPreviewController_a32aeeb35ac5733702fba52df05fdf61d}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Hp@{build\-Hp}}
\index{build\-Hp@{build\-Hp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Hp}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Hp} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Cp, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Bh, }
\item[{\-Eigen\-::\-Matrix\-Xd}]{\-Ah, }
\item[{const int}]{\-Nc, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a32aeeb35ac5733702fba52df05fdf61d}
\-Builds $H_p$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em \-Cp} & $C_p$ \\
\hline
{\em \-Bh} & $B_h$ \\
\hline
{\em \-Ah} & $A_h$ \\
\hline
{\em \-Nc} & $N_c$ \\
\hline
{\em \-Np} & $N_p$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$H_p$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a32ab17a3be30490e4a1e874bf3581843}{\-Zmp\-Preview\-Controller\-::\-Hp} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a23b30df39849a4f22c5ebf94b87e8425}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Nb@{build\-Nb}}
\index{build\-Nb@{build\-Nb}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Nb}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Nb} (
\begin{DoxyParamCaption}
\item[{const double}]{nb, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a23b30df39849a4f22c5ebf94b87e8425}
\-Builds $N_b$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em nb} & $\eta_b$ \\
\hline
{\em \-Np} & $N_p$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$N_b$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_abd345d397e99ae01ad4ea80cd9894802}{\-Zmp\-Preview\-Controller\-::\-Nb} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_ad1322ec975c7d022feb24a40fff62f2e}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Nu@{build\-Nu}}
\index{build\-Nu@{build\-Nu}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Nu}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Nu} (
\begin{DoxyParamCaption}
\item[{const double}]{nu, }
\item[{const int}]{\-Nc}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_ad1322ec975c7d022feb24a40fff62f2e}
\-Builds $N_u$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em nu} & $\eta_u$ \\
\hline
{\em \-Nc} & $N_c$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$N_u$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_ac3e92145988993ede7ce2060b997c8db}{\-Zmp\-Preview\-Controller\-::\-Nu} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a6af233960b02ee593f2b781967fc2f5e}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!build\-Nw@{build\-Nw}}
\index{build\-Nw@{build\-Nw}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{build\-Nw}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::build\-Nw} (
\begin{DoxyParamCaption}
\item[{const double}]{nw, }
\item[{const int}]{\-Np}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a6af233960b02ee593f2b781967fc2f5e}
\-Builds $N_w$. \-Called during the member list initialization of the constructor of this class


\begin{DoxyParams}{\-Parameters}
{\em nw} & $\eta_w$ \\
\hline
{\em \-Np} & $Nc$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$N_w$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a5e85354a1a7c3f2a8e265dbe7367051c}{\-Zmp\-Preview\-Controller\-::\-Nw} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a1f5bf084ce93391fbebd63e467d9adbc}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!compute\-Foot\-Z\-M\-P@{compute\-Foot\-Z\-M\-P}}
\index{compute\-Foot\-Z\-M\-P@{compute\-Foot\-Z\-M\-P}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{compute\-Foot\-Z\-M\-P}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Zmp\-Preview\-Controller\-::compute\-Foot\-Z\-M\-P} (
\begin{DoxyParamCaption}
\item[{{\bf \-F\-O\-O\-T}}]{which\-Foot, }
\item[{\-Eigen\-::\-Vector\-Xd}]{wrench, }
\item[{\-Eigen\-::\-Vector2d \&}]{foot\-Z\-M\-P, }
\item[{\-Eigen\-::\-Vector\-Xd \&}]{wrench\-In\-World\-Ref, }
\item[{ocra\-::\-Model\-::\-Ptr}]{model, }
\item[{const double}]{tolerance = {\ttfamily 1e-\/3}}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a1f5bf084ce93391fbebd63e467d9adbc}
\-Computes the \-Z\-M\-P for a single foot in world reference frame.

\-Assuming that $\mathbf{p}$ is the position of the \-Z\-M\-P for a single foot, $\mathbf{p}_s$ the position of a force torque (\-F/\-T) sensor at the foot, the \-Z\-M\-P position can be computed as\-: \[ \left[\begin{array}{c}p_x \\ p_y \end{array}\right] = \frac{1}{f_z} \left[\begin{array}{cccccc} -p_{s_z} & 0 & p_{s_x} & 0 & -1 & 0 \\ 0 & -p_{s_z} & p_{s_y} & 1 & 0 & 0 \end{array}\right] \left[\begin{array}{c} \mathbf{f}\\ \mathbf{\tau} \end{array}\right] \]


\begin{DoxyParams}[1]{\-Parameters}
 & {\em which\-Foot} & \-L\-E\-F\-T\-\_\-\-F\-O\-O\-T or \-R\-I\-G\-H\-T\-\_\-\-F\-O\-O\-T. \\
\hline
 & {\em wrench} & \-External wrench on the foot as read by the \-F/\-T sensors. \\
\hline
\mbox{\tt out}  & {\em foot\-Z\-M\-P} & \-Foot \-Z\-M\-P in world reference frame. \\
\hline
\mbox{\tt out}  & {\em wrench\-In\-World\-Ref} & \-Transformed wrench in world reference frame. \\
\hline
 & {\em tolerance} & \-Tolerance value below which the \-Z\-M\-P is considered null. \cite{Kajita2014Intro}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-True if all operations proceed successfully. 
\end{DoxyReturn}
\hypertarget{classZmpPreviewController_a46dfe0448f3f14927960a072dc42346d}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!compute\-Global\-Z\-M\-P\-From\-Sensors@{compute\-Global\-Z\-M\-P\-From\-Sensors}}
\index{compute\-Global\-Z\-M\-P\-From\-Sensors@{compute\-Global\-Z\-M\-P\-From\-Sensors}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{compute\-Global\-Z\-M\-P\-From\-Sensors}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Zmp\-Preview\-Controller\-::compute\-Global\-Z\-M\-P\-From\-Sensors} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Vector\-Xd}]{raw\-Left\-Foot\-Wrench, }
\item[{\-Eigen\-::\-Vector\-Xd}]{raw\-Right\-Foot\-Wrench, }
\item[{ocra\-::\-Model\-::\-Ptr}]{model, }
\item[{\-Eigen\-::\-Vector2d \&}]{global\-Z\-M\-P}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a46dfe0448f3f14927960a072dc42346d}
\-Computes the global \-Z\-M\-P for two feet in contact.

\-After obtaining the \-Z\-M\-P position for both feet $\mathbf{p}_R$ and $\mathbf{p}_L$ independently and expressed in the world reference frame, in the case where both feet are in contact with the ground (or just one), the global expression of the \-Z\-M\-P $\mathbf{p}$ expressed in the world reference frame is\-: \[ \left[\begin{array}{c} p_x\\ p_y \end{array}\right] = \frac{1}{f_{R_z} + f_{L_z}} \left[\begin{array}{cc} \mathbf{p}_R & \mathbf{p}_L \end{array}\right] \left[\begin{array}{c} f_{R_z}\\ f_{L_z} \end{array}\right] \]


\begin{DoxyParams}{\-Parameters}
{\em raw\-Left\-Foot\-Wrench} & \-Raw left foot wrench as read from the sensors \mbox{[}force $|$ torque\mbox{]} \\
\hline
{\em raw\-Right\-Foot\-Wrench} & \-Raw right foot wrench as read from the sensors. \\
\hline
{\em global\-Z\-M\-P} & \-Global zmp in world reference frame considering both feet. @ \cite{Kajita2014Intro}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-True if all operations succeed, false otherwise. 
\end{DoxyReturn}
\hypertarget{classZmpPreviewController_aabdafde9ecc41a6d98134e0a01083d8a}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!compute\-Optimal\-Input@{compute\-Optimal\-Input}}
\index{compute\-Optimal\-Input@{compute\-Optimal\-Input}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{compute\-Optimal\-Input}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Derived $>$ void {\bf \-Zmp\-Preview\-Controller\-::compute\-Optimal\-Input} (
\begin{DoxyParamCaption}
\item[{const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&}]{zmp\-Ref, }
\item[{const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&}]{com\-Vel\-Ref, }
\item[{const \-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&}]{hk, }
\item[{\-Eigen\-::\-Matrix\-Base$<$ \-Derived $>$ \&}]{optimal\-U}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classZmpPreviewController_aabdafde9ecc41a6d98134e0a01083d8a}
\-Computes a horizon of optimal inputs (\-Co\-M jerks) to be applied to the system, i.\-e.\-: \begin{align*} \mathcal{U}_{k+N|k} &= (\mathbf{H}_p^T \mathbf{N}_b \mathbf{H}_p + \mathbf{N}_u + \mathbf{H}_h^T \mathbf{N}_w \mathbf{H}_h)^{-1} \left(\mathbf{H}^T_p \mathbf{N}_b (\mathbf{P}_r - \mathbf{G}_p \hat{\mathbf{h}}_k) + \mathbf{H}^T_h\mathbf{N}_w(\tilde{\mathbf{H}}_r - \mathbf{G}_h \hat{\mathbf{h}}_k)\right)\\ \mathcal{U}_{k+N|k} &= \mathbf{A}_{\text{opt}}^{-1} \mathbf{b}_{\text{opt}} \end{align*}

\-This solution is computed through standard \-Cholesky decomposition. \-See \-Eigen\-::\-L\-L\-T for more details. \-Matrix \hyperlink{classZmpPreviewController_a2afe60ed4923414ce4e51a8a7a584fde}{\-Zmp\-Preview\-Controller\-::\-A\-Optimal} is precomputed by the constructor for efficiency reasons.


\begin{DoxyParams}{\-Parameters}
{\em zmp\-Ref} & $\mathbf{P}_r$ \-Horizon of $N_c$ \-Z\-M\-P references. \\
\hline
{\em com\-Vel\-Ref} & $\tilde{\mathbf{H}}_r$ \-Horizon of $N_c$ \-Co\-M velocities. \\
\hline
{\em hk} & \-Current measured \-Co\-M state at time $k$, i.\-e. $\hat{\mathbf{h}}_k$ \\
\hline
{\em optimal\-U} & \-Closed-\/form solution to the unconstrained \-Q\-P problem, $\mathcal{U}_{k+N_c|k}$ \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a2afe60ed4923414ce4e51a8a7a584fde}{\-Zmp\-Preview\-Controller\-::\-A\-Optimal}, \hyperlink{classZmpPreviewController_a049829dccbeb5a7a1bf47f7e6679174a}{\-Zmp\-Preview\-Controller\-::b\-Optimal}
\end{DoxySeeAlso}
\begin{DoxyRefDesc}{\-Todo}
\item[\hyperlink{todo__todo000013}{\-Todo}]\-Remember that the b\-Optimal \-I have to use is actually not \-Weiber's because it doesn't take into account com velocity references.\end{DoxyRefDesc}
\hypertarget{classZmpPreviewController_aa4bbd8b205ae1d539620ec7d5f258d4a}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!get\-F\-T\-Sensor\-Adjoint\-Matrix@{get\-F\-T\-Sensor\-Adjoint\-Matrix}}
\index{get\-F\-T\-Sensor\-Adjoint\-Matrix@{get\-F\-T\-Sensor\-Adjoint\-Matrix}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{get\-F\-T\-Sensor\-Adjoint\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Zmp\-Preview\-Controller\-::get\-F\-T\-Sensor\-Adjoint\-Matrix} (
\begin{DoxyParamCaption}
\item[{{\bf \-F\-O\-O\-T}}]{which\-Foot, }
\item[{\-Eigen\-::\-Matrix\-Xd \&}]{\-T, }
\item[{\-Eigen\-::\-Vector3d \&}]{sensor\-Position, }
\item[{ocra\-::\-Model\-::\-Ptr}]{model}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_aa4bbd8b205ae1d539620ec7d5f258d4a}
\-Retrieves the \-F\-T sensor adjoint matrix expressed in the world reference frame which multiplied by the local measurement of the sensor gives you the measurement in the world reference.


\begin{DoxyParams}[1]{\-Parameters}
 & {\em which\-Foot} & \-L\-E\-F\-T\-\_\-\-F\-O\-O\-T or \-R\-I\-G\-H\-T\-\_\-\-F\-O\-O\-T \\
\hline
\mbox{\tt out}  & {\em \-T} & \-Adjoint matrix. \\
\hline
\mbox{\tt out}  & {\em sensor\-Position} & 3\-D \-Position of the \-F/\-T sensor corresponding to which\-Foot. \\
\hline
 & {\em model} & \-Pointer to the model that must have been initialized by the calling thread. \\
\hline
\end{DoxyParams}
\hypertarget{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!initialize@{initialize}}
\index{initialize@{initialize}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{initialize}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Zmp\-Preview\-Controller\-::initialize} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd}
\-Initializes the matrices and parameters used by the controller.

\-Currently we are not initializing through this method, but through the constructor. \begin{DoxyReturn}{\-Returns}
\-True if successful, false otherwise. 
\end{DoxyReturn}
\hypertarget{classZmpPreviewController_abbf80c91182c5e41ce60d3b7430a583e}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!integrate\-Com@{integrate\-Com}}
\index{integrate\-Com@{integrate\-Com}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{integrate\-Com}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Zmp\-Preview\-Controller\-::integrate\-Com} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Vector\-Xd}]{com\-Jerk, }
\item[{\-Eigen\-::\-Vector\-Xd}]{hk, }
\item[{\-Eigen\-::\-Vector\-Xd \&}]{hkk}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_abbf80c91182c5e41ce60d3b7430a583e}
\-Integrates the \-Co\-M for a given \-Co\-M jerk input. \-Integration matrices $\mathbf{A}_h$ and $\mathbf{b}_h$ are precomputed by the constructor of this class.

\[ \mathbf{h}_{k+1} = \mathbf{A}_h \mathbf{h}_k + \mathbf{B}_h \mathbf{u}_k \]


\begin{DoxyParams}[1]{\-Parameters}
 & {\em com\-Jerk} & \-Input com jerk $\mathbf{u}_k$ \\
\hline
 & {\em hk} & \-Current \-C\-O\-M state $\mathbf{h}_k$ \\
\hline
\mbox{\tt out}  & {\em hkk} & \-Integrated \-C\-O\-M state $\mathbf{h}_{k+1}$ \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{classZmpPreviewController_a39ffdba07960f90a6cce247065f12504}{build\-Ah()}, \hyperlink{classZmpPreviewController_a0114a8bdba920b9a7fb6b35e7b90ddd1}{build\-Bh()} 
\end{DoxySeeAlso}
\hypertarget{classZmpPreviewController_a7d559ce7ece62627b58f20cd01c9ce30}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!table\-Cart\-Model@{table\-Cart\-Model}}
\index{table\-Cart\-Model@{table\-Cart\-Model}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{table\-Cart\-Model}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Zmp\-Preview\-Controller\-::table\-Cart\-Model} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Vector2d}]{hk, }
\item[{\-Eigen\-::\-Vector\-Xd}]{ddhk, }
\item[{\-Eigen\-::\-Vector2d \&}]{p}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a7d559ce7ece62627b58f20cd01c9ce30}
\-Computes a simplified model-\/based \-Z\-M\-P.

\-Computes the zero-\/moment point given the robot's horizontal \-Co\-M acceleration and position, besides a constant \-Co\-M height and gravity acceleration.


\begin{DoxyParams}[1]{\-Parameters}
 & {\em hk} & \-Horizontal \-Co\-M position. \\
\hline
 & {\em ddhk} & \-Horizontal \-Co\-M acceleration. \\
\hline
\mbox{\tt out}  & {\em p} & \-Computed \-Z\-M\-P. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{\-Note}
\-The \-M\-P\-C formulation presented in the description of this controller finds the optimal inputs (jerks) for the system, not the optimal \-Z\-M\-P trajectory! \-This is why, if we want to see what the previewed \-Z\-M\-P reference is, we need to use this table-\/cart model whose inputs are to be integrated from the optimal jerks through \hyperlink{classZmpPreviewController_abbf80c91182c5e41ce60d3b7430a583e}{integrate\-Com()}. 
\end{DoxyNote}
\hypertarget{classZmpPreviewController_a7fa5d122b80650cdd9869b666e1ad597}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!table\-Cart\-Model@{table\-Cart\-Model}}
\index{table\-Cart\-Model@{table\-Cart\-Model}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{table\-Cart\-Model}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Zmp\-Preview\-Controller\-::table\-Cart\-Model} (
\begin{DoxyParamCaption}
\item[{\-Eigen\-::\-Vector\-Xd}]{hkk, }
\item[{\-Eigen\-::\-Vector2d \&}]{p}
\end{DoxyParamCaption}
)}}\label{classZmpPreviewController_a7fa5d122b80650cdd9869b666e1ad597}
\-Computes a simplified model-\/based \-Z\-M\-P.

\-Computes the zero-\/moment point given the robot's horizontal \-Co\-M acceleration and position, besides a constant \-Co\-M height and gravity acceleration.

\[ \mathbf{p}_{k+1} = \mathbf{C}_p \mathbf{h}_{k+1} \]


\begin{DoxyParams}[1]{\-Parameters}
 & {\em hkk} & \-Horizontal \-Co\-M state. \\
\hline
\mbox{\tt out}  & {\em p} & \-Computed \-Z\-M\-P. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{\-Note}
\-The \-M\-P\-C formulation presented in the description of this controller finds the optimal inputs (jerks) for the system, not the optimal \-Z\-M\-P trajectory! \-This is why, if we want to see what the previewed \-Z\-M\-P reference is, we need to use this table-\/cart model whose inputs are to be integrated from the optimal jerks through \hyperlink{classZmpPreviewController_abbf80c91182c5e41ce60d3b7430a583e}{integrate\-Com()}. 
\end{DoxyNote}


\subsection{\-Member \-Data \-Documentation}
\hypertarget{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Ah@{\-Ah}}
\index{\-Ah@{\-Ah}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Ah}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Ah}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a8ee8ec415e25374f4fa687f5a5a6b9df}
\-State matrix $\mathbf{A}_h$ from the linear state process of the \-Co\-Mstate $\hat{\mathbf{h}}$. \-It is a constant matrix of size $6\times6$ equal to\-: \[ \mathbf{A_h} = \left[ \begin{array}{ccc} \mathbf{I}_2 & \delta t \mathbf{I}_2 & \frac{\delta t^2}{2} \mathbf{I}_2 \\ 0 & \mathbf{I}_2 & \delta t \\ 0 & 0 & \mathbf{I}_2 \end{array} \right] \] \hypertarget{classZmpPreviewController_a2afe60ed4923414ce4e51a8a7a584fde}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-A\-Optimal@{\-A\-Optimal}}
\index{\-A\-Optimal@{\-A\-Optimal}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-A\-Optimal}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-A\-Optimal}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a2afe60ed4923414ce4e51a8a7a584fde}
\-Matrix $\mathbf{A}_{\text{opt}}$ in \hyperlink{classZmpPreviewController_aabdafde9ecc41a6d98134e0a01083d8a}{compute\-Optimal\-Input()}. \hypertarget{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Bh@{\-Bh}}
\index{\-Bh@{\-Bh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Bh}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Bh}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a98bd07d03d0a6004b345ef4310cf17b6}
\-Input matrix $\mathbf{B}_h$ from the linear state process of the \-Co\-Mstate $\hat{\mathbf{h}}$. \-It is constant of size $6\times2$ and equal to\-: \[ \mathbf{B_h} = \left[ \begin{array}{c} \frac{\delta^3}{6}\mathbf{I}_2 \\ \frac{\delta t^2}{2} \mathbf{I}_2 \\ \delta t \mathbf{I}_2 \end{array} \right] \] \hypertarget{classZmpPreviewController_a049829dccbeb5a7a1bf47f7e6679174a}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!b\-Optimal@{b\-Optimal}}
\index{b\-Optimal@{b\-Optimal}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{b\-Optimal}]{\setlength{\rightskip}{0pt plus 5cm}\-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::b\-Optimal}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a049829dccbeb5a7a1bf47f7e6679174a}
\-Vector $\mathbf{b}_{\text{opt}}$ in \hyperlink{classZmpPreviewController_aabdafde9ecc41a6d98134e0a01083d8a}{compute\-Optimal\-Input()}. \hypertarget{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Ch@{\-Ch}}
\index{\-Ch@{\-Ch}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Ch}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Ch}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a2093754713ffb2a7adcd1310c73bf775}
\-Output matrix of the \-Co\-Mlinear process state transition where the \-Co\-Mhorizontal velocity is the output. \-It is of size $2\times6$ and equal to\-: \[ \mathbf{C}_h = \left[\begin{array}{ccc} \mathbf{0}_2 & \mathbf{I}_2 & \mathbf{0}_2 \\ \end{array}\right] \] \hypertarget{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Cp@{\-Cp}}
\index{\-Cp@{\-Cp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Cp}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Cp}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a1a63870dcc3d51a26c4adc9c97e650ff}
\-Output matrix $C_p$ from the linear state process relating \-Z\-M\-P to the \-Co\-Mdynamics $\hat{\mathbf{h}}$. \-It is time-\/invariant of size $2\times6$ and equal to\-: \[ \mathbf{C}_p = \left[\begin{array}{ccc} \mathbf{I}_2 & \mathbf{0}_2 & -\frac{c_z}{g}\mathbf{I}_2 \\ \end{array}\right] \] \hypertarget{classZmpPreviewController_a3a317d26cc1bbaf8811491724fdd1def}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!cz@{cz}}
\index{cz@{cz}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{cz}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::cz}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a3a317d26cc1bbaf8811491724fdd1def}
\-Co\-Mconstant height. \-It is not hardcoded but corresponds to the vertical coordinate (height) of the \-Co\-Mat the beginning of execution, i.\-e. $ c_z $. \hypertarget{classZmpPreviewController_abf1a3ec8d1698afab1c20bba32b5a724}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!dt@{dt}}
\index{dt@{dt}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{dt}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::dt}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_abf1a3ec8d1698afab1c20bba32b5a724}
\-Rate of the thread where this \hyperlink{classZmpPreviewController}{\-Zmp\-Preview\-Controller} is executed. \hypertarget{classZmpPreviewController_a344571f012aa58250d7625905681bf1b}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!g@{g}}
\index{g@{g}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{g}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::g} = 9.\-8\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a344571f012aa58250d7625905681bf1b}
\-Gravity constant value in m/s$^\wedge$2, $ g $. \hypertarget{classZmpPreviewController_a9429cb06fdd2c3ca5036a2fd48303632}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Gh@{\-Gh}}
\index{\-Gh@{\-Gh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Gh}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Gh}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a9429cb06fdd2c3ca5036a2fd48303632}
\-State matrix $\mathbf{G}_h$ of size $2N_p \times 6$ from the preview horizon of \-Co\-Mvelocities. \-It is constant and equal to\-: \[ \mathbf{G}_h = \left[\begin{array}{c} \mathbf{C}_h\mathbf{A}_h \\ \vdots \\ \mathbf{C}_h\mathbf{A}^{N_p}_h \end{array}\right] \] \hypertarget{classZmpPreviewController_a53a7d8af5be4a5d5cea99fad2ea48979}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Gp@{\-Gp}}
\index{\-Gp@{\-Gp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Gp}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Gp}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a53a7d8af5be4a5d5cea99fad2ea48979}
\-State matrix $\mathbf{G}_p$ from the preview horizon of \-Z\-M\-P outputs $\mathbf{P}$. \-It is of size $2N_p \times 6$ and equal to\-: \[ \mathbf{G}_p = \left[\begin{array}{c} \mathbf{C}_p\mathbf{A}_h \\ \vdots \\ \mathbf{C}_p\mathbf{A}^{N_p}_h \end{array}\right] \] \hypertarget{classZmpPreviewController_a8caaf8bf8f06e5b0b53d2cd5c131eefd}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Hh@{\-Hh}}
\index{\-Hh@{\-Hh}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Hh}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Hh}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a8caaf8bf8f06e5b0b53d2cd5c131eefd}
\-Input matrix $\mathbf{H}_h$ from the preview horizon of \-Co\-Mvelocities $\tilde{\mathbf{H}}$, of size $2N_p \times 2N_c$ and equal to\-: \[ \mathbf{H}_h = \left[\begin{array}{cccc} \mathbf{C}_h\mathbf{B}_h & 0 & \cdots & 0 \\ \mathbf{C}_h\mathbf{A}_h\mathbf{B}_h & \mathbf{C}_h\mathbf{B}_h & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ \mathbf{C}_h\mathbf{A}^{N_p-1}_h\mathbf{B}_h & \mathbf{C}_h\mathbf{A}^{N_p-2}_h\mathbf{B}_h & \cdots & \mathbf{C}_h\mathbf{A}^{N_p - N_c}\mathbf{B}_h \end{array}\right] \] \hypertarget{classZmpPreviewController_a32ab17a3be30490e4a1e874bf3581843}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Hp@{\-Hp}}
\index{\-Hp@{\-Hp}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Hp}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Hp}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a32ab17a3be30490e4a1e874bf3581843}
\-Input matrix $\mathbf{H}_p$ from the preview horizon of \-Z\-M\-P outputs $\mathbf{P}$. \-It is of size $2N_p \times 2N_c$ and equal to\-: \[ \mathbf{H}_p = \left[\begin{array}{cccc} \mathbf{C}_p\mathbf{B}_h & 0 & \cdots & 0 \\ \mathbf{C}_p\mathbf{A}_h\mathbf{B}_h & \mathbf{C}_p\mathbf{B}_h & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ \mathbf{C}_p\mathbf{A}^{N_p-1}_h\mathbf{B}_h & \mathbf{C}_p\mathbf{A}^{N_p-2}_h\mathbf{B}_h & \cdots & \mathbf{C}_p\mathbf{A}_p^{N_p - N_c}\mathbf{B}_h \end{array}\right] \] \hypertarget{classZmpPreviewController_a6716ee4c94e6f91e608ee1e29fbc7051}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!nb@{nb}}
\index{nb@{nb}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{nb}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::nb}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a6716ee4c94e6f91e608ee1e29fbc7051}
\-Weight of the balancing cost function $ \eta_b $ \hypertarget{classZmpPreviewController_abd345d397e99ae01ad4ea80cd9894802}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Nb@{\-Nb}}
\index{\-Nb@{\-Nb}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Nb}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Nb}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_abd345d397e99ae01ad4ea80cd9894802}
\-Diagonal matrix $N_b = \eta_b\mathbf{I}_{2N_p}$ of size $[2N_p \times 2N_p]$ weighting the balancing cost function in its matrix form. \hypertarget{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Nc@{\-Nc}}
\index{\-Nc@{\-Nc}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Nc}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Zmp\-Preview\-Controller\-::\-Nc}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_af0c8b4aa92a6e3e95f80d81a8c91f693}
\-Size of control window $ N_c $. \-It should less or equal to $Np$. \hypertarget{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Np@{\-Np}}
\index{\-Np@{\-Np}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Np}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Zmp\-Preview\-Controller\-::\-Np}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a2de373daf73b4c28f4b6387787bd27e2}
\-Size of preview window $ N_p $. \-It should be greater or equal to $N_c$. \hypertarget{classZmpPreviewController_ac611f084023404faba1ccfab573cd81d}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!nu@{nu}}
\index{nu@{nu}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{nu}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::nu}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_ac611f084023404faba1ccfab573cd81d}
\-Weight of the input regularization term in the cost function $\eta_u$ \hypertarget{classZmpPreviewController_ac3e92145988993ede7ce2060b997c8db}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Nu@{\-Nu}}
\index{\-Nu@{\-Nu}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Nu}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Nu}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_ac3e92145988993ede7ce2060b997c8db}
\-Diagonal matrix $N_u = \eta_u\mathbf{I}_{2N_c}$ of size $[2N_c \times 2N_c]$ weighting the input regularization term in the matricial expression of the controller's cost function. \hypertarget{classZmpPreviewController_a783427b817d77469e1f80426bede5310}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!nw@{nw}}
\index{nw@{nw}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{nw}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf \-Zmp\-Preview\-Controller\-::nw}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a783427b817d77469e1f80426bede5310}
\-Weight of the walking cost function $ \eta_w $ \hypertarget{classZmpPreviewController_a5e85354a1a7c3f2a8e265dbe7367051c}{\index{\-Zmp\-Preview\-Controller@{\-Zmp\-Preview\-Controller}!\-Nw@{\-Nw}}
\index{\-Nw@{\-Nw}!ZmpPreviewController@{\-Zmp\-Preview\-Controller}}
\subsubsection[{\-Nw}]{\setlength{\rightskip}{0pt plus 5cm}const \-Eigen\-::\-Matrix\-Xd {\bf \-Zmp\-Preview\-Controller\-::\-Nw}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classZmpPreviewController_a5e85354a1a7c3f2a8e265dbe7367051c}
\-Diagonal matrix $N_w\ = \eta_w\mathbf{I}_{2N_p}$ of size $[2N_p \times 2N_p]$ weighting the walking cost function in its matrix form. 

\-The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
ocra-\/wbi-\/plugins/ocra-\/icub-\/clients/walking-\/client/include/walking-\/client/\hyperlink{ZmpPreviewController_8h}{\-Zmp\-Preview\-Controller.\-h}\item 
ocra-\/wbi-\/plugins/ocra-\/icub-\/clients/walking-\/client/src/\hyperlink{ZmpPreviewController_8cpp}{\-Zmp\-Preview\-Controller.\-cpp}\end{DoxyCompactItemize}
